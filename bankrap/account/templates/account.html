<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BankRap - Account Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom Font Import */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background-color: #f9fafb;
        }
        .transition-all {
            transition: all 0.3s ease;
        }
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 25px -5px rgba(37, 99, 235, 0.1); /* Subtle blue hover shadow */
        }
        .nav-link.active {
            color: #2563eb; /* blue-600 */
            background-color: #eff6ff; /* blue-50 */
            border-radius: 0.375rem; /* rounded-md */
        }
        /* New custom card styling */
        .profile-card {
            border-radius: 1rem; /* rounded-xl */
            overflow: hidden;
        }
        .card-header-bg {
            height: 60px;
            background-image: linear-gradient(to right, #3b82f6, #6366f1); /* blue-500 to indigo-500 */
        }
    </style>
</head>
<body>
    <div id="app">
        <nav class="bg-white shadow-md sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 flex items-center">
                            <div class="w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center mr-2">
                                <span class="text-white font-bold text-lg">B</span>
                            </div>
                            <span class="text-2xl font-bold">
                                Bank<span class="text-blue-600">Rap</span>
                            </span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="hidden md:block">
                            <div class="flex items-baseline space-x-8">
                                <a href="/account/" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors active" data-page="accounts">Accounts</a>
                                <a href="/loan/" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors" data-page="loans">Loans</a>
                                <a href="/wallet/" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors" data-page="wallet">Wallet</a>
                                <a href="/transaction/" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors" data-page="transactions">Transactions</a>
                                <a href="/review/" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors" data-page="reviews">Reviews</a>
                            </div>
                        </div>

                        <div class="ml-4 flex items-center md:ml-6">
                            <div class="relative">
                                <button onclick="toggleProfileMenu()" class="max-w-xs bg-gray-200 rounded-full flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 p-1" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                                    <span class="sr-only">Open user menu</span>
                                    <div class="h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center">
                                        <i class="fas fa-user text-white text-base"></i>
                                    </div>
                                </button>

                                <div id="profileMenu" class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none hidden" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1">
                                    <div class="px-4 py-2 text-sm text-gray-700 border-b border-gray-100">
                                        <p class="font-bold">Admin User</p>
                                        <p class="text-xs text-gray-500">admin@bankrap.com</p>
                                    </div>
                                    <a href="/account/profile/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" role="menuitem" tabindex="-1" id="user-menu-item-0">
                                        <i class="fas fa-id-card-alt mr-2 text-blue-600"></i> View Profile
                                    </a>
                                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" role="menuitem" tabindex="-1" id="user-menu-item-1">
                                        <i class="fas fa-sign-out-alt mr-2 text-red-500"></i> Sign out
                                    </a>
                                </div>
                            </div>

                            <div class="md:hidden ml-4">
                                <button onclick="toggleMenu()" class="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-blue-600 focus:outline-none">
                                    <i class="fas fa-bars text-2xl"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="navLinks" class="hidden md:hidden bg-white border-t">
                <a href="/account/" class="nav-link text-gray-700 hover:text-blue-600 block px-3 py-2 text-base font-medium active">Accounts</a>
                <a href="/loan/" class="nav-link text-gray-700 hover:text-blue-600 block px-3 py-2 text-base font-medium">Loans</a>
                <a href="/wallet/" class="nav-link text-gray-700 hover:text-blue-600 block px-3 py-2 text-base font-medium">Wallet</a>
                <a href="/transaction/" class="nav-link text-gray-700 hover:text-blue-600 block px-3 py-2 text-base font-medium">Transactions</a>
                <a href="/review/" class="nav-link text-gray-700 hover:text-blue-600 block px-3 py-2 text-base font-medium">Reviews</a>
            </div>
        </nav>

        <main class="py-8 px-4">
            <div id="content"></div>
        </main>

    </div>

    <script>
        // --- Configuration for Current User (Mock) ---
        // 'L' for Lender, 'B' for Borrower. Change this value to test the filtering.
        const currentClientType = 'L'; // Example: The currently logged-in user is a Lender.

        // --- Mock Data (Updated to include full profile data for each user) ---
        const mockAccounts = [
            {
                userId: 1, name: 'John Smith', type: 'L', availableFunds: 25000.00,
                email: 'john.smith@example.com', address: '123 Investment Ave, Manila, Philippines',
                contactNumber: '+63 (915) 123-4567', investmentPreference: 'Low-risk loans with steady returns, preference for secured loans',
                minInvestmentAmount: 2500.00, profileCreatedDate: '2024-01-15', loansFunded: 8, rating: 4.5
            },
            {
                userId: 2, name: 'Sarah Johnson', type: 'B', creditScore: 720,
                email: 'sarah.johnson@example.com', address: '456 Borrower St, Quezon City, Philippines',
                contactNumber: '+63 (920) 987-6543', income: 325000.00,
                employmentStatus: 'Full-time Software Engineer', profileCreatedDate: '2024-02-20', loanCount: 3, lastLoanDate: '2024-10-01'
            },
            {
                userId: 3, name: 'Michael Chen', type: 'L', availableFunds: 62500.00,
                email: 'michael.chen@example.com', address: '789 Capital Road, Pasig City, Philippines',
                contactNumber: '+63 (998) 555-1234', investmentPreference: 'High-yield, medium-risk, focus on tech startups',
                minInvestmentAmount: 5000.00, profileCreatedDate: '2023-11-01', loansFunded: 22, rating: 4.9
            },
            {
                userId: 4, name: 'Emily Davis', type: 'B', creditScore: 680,
                email: 'emily.davis@example.com', address: '321 Loan Street, Cebu City, Philippines',
                contactNumber: '+63 (922) 111-0000', income: 210000.00,
                employmentStatus: 'Self-employed Artist', profileCreatedDate: '2024-03-10', loanCount: 1, lastLoanDate: '2024-11-20'
            }
        ];

        let currentPage = 'accounts';
        let selectedProfileData = null; // Store the data of the profile that was clicked

        // --- New/Updated Functions ---

        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('hidden');
        }

        function toggleProfileMenu() {
            const profileMenu = document.getElementById('profileMenu');
            profileMenu.classList.toggle('hidden');
        }

        // Close profile menu when clicking outside
        document.addEventListener('click', function(event) {
            const profileMenu = document.getElementById('profileMenu');
            const userMenuButton = document.getElementById('user-menu-button');
            if (profileMenu && userMenuButton && !userMenuButton.contains(event.target) && !profileMenu.contains(event.target) && !profileMenu.classList.contains('hidden')) {
                profileMenu.classList.add('hidden');
            }
        });

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-PH', {
                style: 'currency', currency: 'PHP', minimumFractionDigits: 2, maximumFractionDigits: 2
            }).format(amount);
        }

        function getCreditScoreColor(score) {
            if (score >= 750) return 'bg-green-100 text-green-800';
            if (score >= 650) return 'bg-yellow-100 text-yellow-800';
            return 'bg-red-100 text-red-800';
        }

        function getCreditScoreLabel(score) {
            if (score >= 750) return 'Excellent';
            if (score >= 650) return 'Good';
            if (score >= 550) return 'Fair';
            return 'Poor';
        }

        // --- Render functions (Updated for Social Media/Profile Card Style) ---

        function renderAccountsList() {
            const oppositeType = currentClientType === 'L' ? 'B' : 'L';
            const filteredAccounts = mockAccounts.filter(account => account.type === oppositeType);

            if (filteredAccounts.length === 0) {
                 return `
                    <div class="max-w-6xl mx-auto text-center py-12">
                        <i class="fas fa-search-dollar text-6xl text-gray-300 mb-4"></i>
                        <h2 class="text-2xl font-bold text-gray-700 mb-2">No Matching Accounts Found</h2>
                        <p class="text-gray-500">
                            You are a <span class="font-semibold">${currentClientType === 'L' ? 'Lender' : 'Borrower'}</span>, so you are only shown
                            <span class="font-semibold">${currentClientType === 'L' ? 'Borrowers' : 'Lenders'}</span>.
                        </p>
                    </div>
                 `;
            }

            return `
                <div class="max-w-6xl mx-auto">
                    <h2 class="text-3xl font-bold text-center mb-4 text-blue-600">
                        Discover ${oppositeType === 'L' ? 'Lenders' : 'Borrower Applicants'}
                    </h2>
                    <p class="text-center text-gray-500 mb-8">
                        Explore profiles below to find investment opportunities or funding partners.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${filteredAccounts.map(account => {
                            const isLender = account.type === 'L';
                            const badgeColor = isLender ? 'bg-blue-600' : 'bg-green-600';
                            const badgeText = isLender ? 'Top Lender' : 'Verified Borrower';

                            let primaryStatIcon = isLender ? 'fas fa-peso-sign' : 'fas fa-star';
                            let primaryStatLabel = isLender ? 'Available Funds' : 'Credit Score';
                            let primaryStatValue = isLender ? formatCurrency(account.availableFunds) : account.creditScore;

                            let secondaryStatIcon = isLender ? 'fas fa-chart-bar' : 'fas fa-briefcase';
                            let secondaryStatLabel = isLender ? 'Loans Funded' : 'Employment';
                            let secondaryStatValue = isLender ? `${account.loansFunded} Loans` : account.employmentStatus.split(' ')[0];

                            let tertiaryStatIcon = isLender ? 'fas fa-star-half-alt' : 'fas fa-calendar-check';
                            let tertiaryStatLabel = isLender ? 'Average Rating' : 'Last Loan Date';
                            let tertiaryStatValue = isLender ? `${account.rating}/5.0` : new Date(account.lastLoanDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

                            return `
                                <div class="bg-white profile-card shadow-lg hover-lift transition-all duration-300 cursor-pointer border border-gray-100" onclick="selectAccount(${account.userId})">
                                    <div class="card-header-bg relative">
                                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 translate-y-4">
                                            <div class="w-20 h-20 rounded-full bg-white flex items-center justify-center border-4 border-white shadow-md">
                                                <i class="fas fa-user-circle text-4xl text-gray-400"></i>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="pt-14 pb-4 px-4 text-center">
                                        <div class="flex flex-col items-center">
                                            <h3 class="font-extrabold text-xl text-gray-800">${account.name}</h3>
                                            <span class="mt-1 text-xs font-semibold px-3 py-1 rounded-full text-white ${badgeColor}">
                                                <i class="fas ${isLender ? 'fa-medal' : 'fa-check-circle'} mr-1"></i> ${badgeText}
                                            </span>
                                            <p class="text-xs text-gray-500 mt-2">${account.address.split(',')[0]}</p>
                                        </div>
                                    </div>

                                    <div class="flex justify-around border-t border-gray-100 pt-4 pb-6 bg-gray-50">
                                        <div class="text-center">
                                            <i class="${primaryStatIcon} text-lg ${isLender ? 'text-blue-500' : 'text-yellow-600'}"></i>
                                            <p class="text-xs font-medium text-gray-500 mt-1">${primaryStatLabel}</p>
                                            <p class="font-bold text-sm text-gray-800">${primaryStatValue}</p>
                                        </div>
                                        <div class="text-center">
                                            <i class="${secondaryStatIcon} text-lg ${isLender ? 'text-purple-500' : 'text-gray-500'}"></i>
                                            <p class="text-xs font-medium text-gray-500 mt-1">${secondaryStatLabel}</p>
                                            <p class="font-bold text-sm text-gray-800">${secondaryStatValue}</p>
                                        </div>
                                        <div class="text-center">
                                            <i class="${tertiaryStatIcon} text-lg ${isLender ? 'text-orange-500' : 'text-blue-500'}"></i>
                                            <p class="text-xs font-medium text-gray-500 mt-1">${tertiaryStatLabel}</p>
                                            <p class="font-bold text-sm text-gray-800">${tertiaryStatValue}</p>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        // The detailed profile render functions (renderLenderProfile and renderBorrowerProfile)
        // are retained with their current structure as the user only requested changes to the
        // main accounts list page, not the detail page.

        function renderLenderProfile() {
            // Use the selectedProfileData instead of generic mockLenderProfile
            const profile = selectedProfileData;
            if (!profile || profile.type !== 'L') return '';

            return `
                <div class="bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto">
                    <div class="mb-6">
                        <button onclick="goBack()" class="text-blue-600 hover:text-blue-800 font-medium flex items-center mb-4">
                            <i class="fas fa-arrow-left mr-2"></i> Back to Accounts
                        </button>
                    </div>
                    <div class="border-b border-gray-200 pb-4 mb-4">
                        <div class="flex items-center justify-between">
                            <h2 class="text-2xl font-bold text-gray-800">${profile.name}</h2>
                            <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full">Lender</span>
                        </div>
                        <p class="text-gray-600 mt-1">${profile.email}</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <p class="text-sm text-gray-500">Address</p>
                            <p class="text-gray-800 font-medium">${profile.address}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Contact Number</p>
                            <p class="text-gray-800 font-medium">${profile.contactNumber}</p>
                        </div>
                    </div>

                    <div class="bg-blue-50 rounded-lg p-4 mb-4">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-chart-line text-blue-600 mr-2"></i>
                            <p class="text-sm text-gray-600">Investment Preference</p>
                        </div>
                        <p class="text-gray-800 font-medium">${profile.investmentPreference}</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="bg-green-50 rounded-lg p-4">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-peso-sign text-green-600 mr-2"></i>
                                <p class="text-sm text-gray-600">Available Funds</p>
                            </div>
                            <p class="text-2xl font-bold text-green-700">${formatCurrency(profile.availableFunds)}</p>
                        </div>
                        <div class="bg-orange-50 rounded-lg p-4">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-peso-sign text-orange-600 mr-2"></i>
                                <p class="text-sm text-gray-600">Min. Investment</p>
                            </div>
                            <p class="text-2xl font-bold text-orange-700">${formatCurrency(profile.minInvestmentAmount)}</p>
                        </div>
                    </div>

                    <div class="mt-4 flex items-center text-sm text-gray-500">
                        <i class="fas fa-calendar mr-2"></i>
                        <span>Profile created: ${new Date(profile.profileCreatedDate).toLocaleDateString('en-PH', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                    </div>
                </div>
            `;
        }

        function renderBorrowerProfile() {
            // Use the selectedProfileData instead of generic mockBorrowerProfile
            const profile = selectedProfileData;
            if (!profile || profile.type !== 'B') return '';

            return `
                <div class="bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto">
                    <div class="mb-6">
                        <button onclick="goBack()" class="text-blue-600 hover:text-blue-800 font-medium flex items-center mb-4">
                            <i class="fas fa-arrow-left mr-2"></i> Back to Accounts
                        </button>
                    </div>
                    <div class="border-b border-gray-200 pb-4 mb-4">
                        <div class="flex items-center justify-between">
                            <h2 class="text-2xl font-bold text-gray-800">${profile.name}</h2>
                            <span class="bg-green-100 text-green-800 text-xs font-semibold px-3 py-1 rounded-full">Borrower</span>
                        </div>
                        <p class="text-gray-600 mt-1">${profile.email}</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <p class="text-sm text-gray-500">Address</p>
                            <p class="text-gray-800 font-medium">${profile.address}</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Contact Number</p>
                            <p class="text-gray-800 font-medium">${profile.contactNumber}</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="${getCreditScoreColor(profile.creditScore)} rounded-lg p-4">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-credit-card mr-2"></i>
                                <p class="text-sm">Credit Score</p>
                            </div>
                            <p class="text-3xl font-bold">${profile.creditScore}</p>
                            <p class="text-sm mt-1 font-medium">${getCreditScoreLabel(profile.creditScore)}</p>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-4">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-peso-sign text-blue-600 mr-2"></i>
                                <p class="text-sm text-gray-600">Monthly Income</p>
                            </div>
                            <p class="text-2xl font-bold text-blue-700">${formatCurrency(profile.income)}</p>
                        </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4 mb-4">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-briefcase text-gray-600 mr-2"></i>
                            <p class="text-sm text-gray-600">Employment Status</p>
                        </div>
                        <p class="text-gray-800 font-medium">${profile.employmentStatus}</p>
                    </div>

                    <div class="mt-4 flex items-center text-sm text-gray-500">
                        <i class="fas fa-calendar mr-2"></i>
                        <span>Profile created: ${new Date(profile.profileCreatedDate).toLocaleDateString('en-PH', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                    </div>
                </div>
            `;
        }


        function render() {
            const contentDiv = document.getElementById('content');
            if (currentPage === 'accounts') {
                contentDiv.innerHTML = renderAccountsList();
            } else if (currentPage === 'lender') {
                contentDiv.innerHTML = renderLenderProfile();
            } else if (currentPage === 'borrower') {
                contentDiv.innerHTML = renderBorrowerProfile();
            }
        }

        function selectAccount(userId) {
            // Find the full account/profile data for the selected user
            const account = mockAccounts.find(a => a.userId === userId);
            selectedProfileData = account; // Store the specific profile data

            if (account.type === 'L') {
                currentPage = 'lender';
            } else {
                currentPage = 'borrower';
            }
            render();
        }

        function goBack() {
            currentPage = 'accounts';
            selectedProfileData = null; // Clear selected data
            render();
        }

        document.addEventListener('DOMContentLoaded', render);
    </script>
</body>
</html>